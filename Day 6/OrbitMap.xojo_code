#tag Class
Protected Class OrbitMap
	#tag Method, Flags = &h0
		Function Calculate() As Integer
		  Var Result As Integer
		  For Each Entry As DictionaryEntry In Finder
		    Var CurrentObject As SpaceObject = Entry.Value
		    Result = Result + CurrentObject.CountChilds
		  Next
		  
		  Return Result
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Function CalculateOrbitsBetween(Origin As SpaceObject, Destination As SpaceObject) As Integer
		  Var OrbitsCount As Integer
		  Var CommonParent As SpaceObject
		  
		  Var OriginParents() As SpaceObject = Origin.GetAllParents
		  Var DestinationParents() As SpaceObject = Destination.GetAllParents
		  Var CommonParents As New Dictionary
		  For Each Parent As SpaceObject In OriginParents
		    CommonParents.Value(Parent.Name) = Parent
		  Next
		  
		  For Each Parent As SpaceObject In DestinationParents
		    If Not CommonParents.HasKey(Parent.Name) Then Continue
		    CommonParent = Parent
		    Exit For
		  Next
		  
		  Var CurrentOriginParent As SpaceObject = Origin.Parent
		  Var CurrentDestinationParent As SpaceObject = Destination.Parent
		  
		  Do
		    If CurrentOriginParent <> CommonParent Then
		      CurrentOriginParent = CurrentOriginParent.Parent
		      OrbitsCount = OrbitsCount + 1
		    End If
		    
		    If CurrentDestinationParent <> CommonParent Then
		      CurrentDestinationParent = CurrentDestinationParent.Parent
		      OrbitsCount = OrbitsCount + 1
		    End If
		  Loop Until CurrentOriginParent = CurrentDestinationParent
		  
		  Return OrbitsCount
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Function CountDirectOrbits() As Integer
		  
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Function CountIndirectOrbits() As Integer
		  
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub LoadInput()
		  Finder = New Dictionary
		  Finder.Value("COM") = New SpaceObject("COM")
		  
		  For Each Line As String In Input.Split(EndOfLine)
		    Var Objects() As String = Line.Split(")")
		    Var Parent As SpaceObject = Finder.Lookup(Objects(0), New SpaceObject(Objects(0)))
		    Var Child As SpaceObject = Finder.Lookup(Objects(1), New SpaceObject(Objects(1)))
		    Parent.Childs.AddRow Child
		    Child.Parent = Parent
		    Finder.Value(Objects(0)) = Parent
		    Finder.Value(Objects(1)) = Child
		  Next
		End Sub
	#tag EndMethod


	#tag Property, Flags = &h0
		CenterOfMass As SpaceObject
	#tag EndProperty

	#tag Property, Flags = &h0
		Finder As Dictionary
	#tag EndProperty


	#tag Constant, Name = Input, Type = String, Dynamic = False, Default = \"S5F)4L5\n7BP)2V1\nDHC)KGY\nJZG)PN7\nRV4)123\n2DJ)LPW\n19G)31B\nH4Z)TC6\n3YP)XTQ\nH9Q)QXJ\nR77)3FM\nJD3)GXY\n3WS)YHL\nX9K)BWP\n656)7PW\n9S2)LGY\nCZB)VXR\n1YS)Y5H\n1XY)L9Y\nNH1)YW5\nHVD)2PS\nY1C)4SY\nLKH)1PV\n7HZ)GZD\nTJZ)WV7\nV8K)Z28\nDB4)S1Q\nTRV)4TM\n3L3)6YN\nLD1)4PR\n1XP)3YF\nB6Q)QRX\nQSL)JV7\nMFC)QSJ\nTC2)9JZ\nPLS)2TK\nT6Y)DNB\nHDT)BY7\n44G)FF3\n682)PLS\n91Z)DNX\nWKK)JWP\nFF3)F32\nCGL)F92\nYCF)8XZ\nVKQ)J6C\nDP4)6JF\nDWB)5RF\n5TG)WRP\nLWN)N2C\n5QB)34Z\nLK9)FB9\nVK9)WQM\nPLR)DP7\nBLV)KL4\n2XT)R7V\nCP3)TJT\n7GT)1XP\n5J1)Z44\nZ8V)MDX\nRQK)RVX\nK55)PSY\nLK4)2CR\n3FL)L74\nBDW)531\nXQZ)GST\n5DP)7G2\n78T)1VZ\nH41)4GK\n7PW)B9Q\nXSH)GF8\nQJ8)YTT\nRS9)844\nGRL)LD1\nK2Z)682\n961)25P\nFT4)2RJ\nSCW)P4C\n7QD)L3G\nK2T)J8P\n948)NFS\nFB9)M3G\n7J9)JLP\nT44)PGK\nRFG)BKG\nNBJ)DZL\n6RR)BLV\nMCF)5F9\n83D)X5V\nX3Z)Q8H\n1HP)Y7X\nTHT)S1K\n2DL)Z75\n9YN)KD7\nSKM)6LN\nVRY)3RX\nZCB)66N\nT95)THD\nSYS)3FL\n2TK)H9F\nCH7)P49\nLYT)XDG\nFF3)LTR\n92Q)C8J\nZRB)MB8\nMLT)GK7\n2D1)534\n2Q9)1GT\n4MP)H4Z\nVB9)HJJ\nRBR)WFF\nY2N)XZS\nD2F)FMW\n4R6)PJY\n2TK)R7K\nF8N)ZJ8\nR99)4B6\nWDW)ZXK\nYJM)LWY\nCFR)Y1C\n3YF)3L3\nMT1)LYT\n6GC)ZX4\nLJ6)LWN\nFH1)PP2\nL89)Z9V\n3W9)BDW\nZYT)RS5\nGK7)DNV\n2RJ)THS\nKGV)N5R\nKF8)P78\nDM1)2QX\nFDZ)LTT\n6BG)LRC\nHFL)GXZ\nLQY)B5J\nYD8)7XZ\n6BQ)Y1R\nMQ9)46Z\nDMQ)BZN\nF8L)KGV\nCG8)YJM\n3Q6)JT6\nF1T)SX8\nGL3)NWX\nPTR)4MP\nLWY)S92\nCQ5)1XY\nTM4)8DK\nM7B)D1G\n27S)YD8\n2MY)5LF\nMYK)RBR\n9ZB)KZF\n4G3)CFR\n52N)RS9\n9PF)687\nCGL)XQZ\nJRY)T9W\nGYT)MMC\nJWP)KZ5\nTTD)QBG\n5LF)53T\nC9C)XBY\n1JF)F8N\nWQM)QHS\n17L)3MX\n5BP)7FJ\n531)D2D\n7X9)YMW\n9XQ)B6Q\n6QG)RHS\nGQF)W6N\nR3T)SQ3\nPRL)KL3\n4XW)N2S\n1QH)V5H\nMXH)82H\n8GN)KJT\nY7D)8VF\nH8K)9GG\nXFM)6B5\nR1C)GYT\nQG4)YBY\n8CR)CKP\nR74)ZNT\nH9F)RKT\nSJN)7FZ\n3VH)RSQ\nBWB)SF1\nH6V)Y1G\nZVG)HFL\nVHL)TG2\nKNJ)CHP\nCOM)YCD\nX4G)6BG\nT62)XM8\nQKZ)YPJ\nP1X)5F8\n7RX)VXM\nV93)9S5\nHKY)5ZW\nQLR)GZZ\nN41)WPZ\nD94)J9X\nSHQ)STJ\nN3P)W37\nL9Y)K3X\n9T5)HVD\nL7M)JYG\nFBZ)CBW\nL78)N12\nR6M)2Q9\nYJN)HDT\nF92)9DM\nWPZ)ZT2\nGF3)XDB\nPCL)HPZ\n3TN)NMH\nS5D)JKP\nKC2)MGQ\nMYN)KJF\nBZN)7X8\nVQY)WB1\n73H)61M\n6WW)73B\nY1G)SRS\nD4C)ZRB\n4JT)LK4\n79C)PVF\nZ5K)6QG\n7RG)QNJ\nRLM)D26\n1Z9)58H\n655)JD3\nGFV)S8S\nXF3)SZW\nX6T)B57\nRFG)T6X\nTC6)MCF\nRYF)7J9\n4GK)17L\nPW2)441\nKGY)S75\nYD8)LJ6\nW5W)SHQ\nBDP)K2T\nB9Q)4JT\nJYX)ZL9\n8HW)BBN\nQSJ)MT5\nT18)GZC\nGZD)T5J\nVXM)3WS\nPGM)N41\nWPB)CSZ\n4WW)PMQ\nM37)L4B\nST4)1XQ\n7T9)9YN\n5NW)RLM\n17N)R8S\n8XZ)7RX\nCKD)5VM\nCBW)83D\nLM1)H6Q\nK2Y)656\n1VZ)NKV\nDT8)PPB\nN7M)FT4\nP2K)5J1\nHGB)FDB\nBLF)L89\n37S)MYD\nFFC)YCF\nK4Q)77S\n6JF)VVP\nKLM)8T1\nN7M)5V5\nFRW)6BQ\nB78)35G\n91D)W3W\n34Z)Z3J\nWB1)DY8\nL4B)NBJ\nN5R)PY8\nSVK)R1C\nFX2)QSL\nN2S)T62\n82H)F6M\n7FZ)B64\n9JZ)8TM\n4TM)Q5T\n84W)57M\n5CL)355\n4W4)KTK\n23R)V8K\nLTT)CQ5\nSZW)3GH\nXRM)PTR\nBT5)Q5H\nQJ1)XF3\nV9C)ZYT\nY1G)NYQ\nDN6)9GX\n5ZW)3VH\n7LP)5D4\nNWX)6VP\nD26)BW5\nMT5)MMM\nQMY)4LX\n73B)CGK\nPF5)H9Q\nMB7)KB1\nWTR)1YS\nHPZ)FRW\nKWJ)XR4\n8RN)9T5\nKTK)QLR\nTFQ)VQY\nQ97)3YP\n452)L19\nT33)WJ9\nQG4)459\n6WP)QMY\nKD7)G1M\nYGC)QF3\n67W)DT8\nRK8)TBP\nJKZ)MQ9\nKHP)M4P\n3RX)MXL\n7XZ)VRY\nGZC)T3X\nS99)5RY\n441)GL3\n38N)P2K\n37J)Z5K\nGTT)5G4\nQHT)4GJ\n1PV)961\n5RN)3JQ\nH4P)8CR\nSSW)LSP\nS58)SAN\nYHL)PQL\nQ8M)9NV\nFKZ)VJR\nT8J)3TN\n4PC)PCL\nRS9)THT\n3FM)FFJ\n8DK)RYF\nXTQ)92W\nP78)CFW\nBW5)PRL\nS75)G2N\nJKN)3QG\nJ7G)MD9\nSWJ)52N\nS8S)9L3\nH8X)K2Y\nW1R)9PF\n5SX)RK8\n1HP)3V4\nZCB)BLF\n88M)ZGM\nQHS)Z6Z\nDNV)H6S\nSPZ)R9K\nZ7M)JKZ\nR7V)TJB\nWRF)HFN\n5JM)DJH\nZN2)RSH\n61M)PGM\nCBN)8NX\nRRW)3SH\nLYM)92Q\nRJK)XRM\n534)S8T\nCP1)KNJ\n8XZ)C56\nSZW)JHV\nH9F)5RN\nSX8)1L1\n74B)4XW\n1GT)WDW\n64W)PTS\n158)7B1\n2S3)VFY\nTJT)43T\n35G)MXP\nYY6)R6M\nV53)64C\nY29)8WD\nQF3)T44\n4GJ)W1R\nK4Q)CP1\nGR4)Q1P\nK6J)HHR\nR6H)1S1\nXMH)GHQ\nBWP)ZJ7\n274)HKY\n553)LLP\nT5J)1KT\nQ5H)LYM\nHQ1)HXW\n1GT)PQZ\nPPB)TM4\nNWG)VXQ\nP23)Y14\n2PS)37S\n2V1)VGY\nMYD)2R4\n1L1)D85\nXDG)39V\nMR1)78T\nVFK)HN7\n6W5)JHS\nF32)698\nGRB)33M\nGX6)SSL\nL71)T18\nY7X)6HM\nJKN)7Z9\nYBY)17N\nV29)DP4\nFN3)2DJ\n33Y)K55\nY63)N9H\nT8W)TFQ\nXYN)M6D\nKSQ)RV4\n66N)3W9\nY1R)79C\nTG2)MT1\nQVR)5DC\n3JJ)QKM\n698)RNB\n6VP)655\n8L8)4G9\nRS5)VK9\nD85)44G\n225)7X9\nQPD)VG9\n39V)5TV\nT7S)K4Q\nLV1)21W\n8R4)6WW\n2PR)JRS\nD1G)19G\n7G2)K6J\n2SY)5CL\nQPZ)QHT\n3SH)H8K\n123)YGC\n7B1)1XC\nSK7)8GN\nRNB)5TG\n3JQ)WKF\nSF1)KC2\nP49)JGH\n4HQ)X6T\nQH4)32W\nY8B)Q7W\nSK4)4XH\nWYS)CQ3\n33M)FBZ\nR56)635\nCFW)1DL\n4L5)R95\n6QH)PFR\n7Z9)91Z\nRDQ)CKV\nPVF)MFC\nMMM)73H\nBHH)LK9\nQ5T)FX2\nJHV)6WB\n8TM)931\nJYG)VRC\nDXD)Q91\nXQ3)R6H\n5RL)CKD\n92W)F31\nSQ3)JYX\nZ6Z)XQ3\n5RF)P23\nDP7)QVR\nHXW)C1F\n3SH)FVW\nWV7)5NW\nPNZ)RM4\nC56)TS1\nBVV)F97\n9S5)H5L\n355)9GD\nYQC)DWZ\nFPW)F9K\n459)HQ1\nYPJ)F1T\nXZS)8RN\n5V5)DMQ\n9HH)3JJ\nGZZ)1J8\nC41)DHC\nH3D)KSQ\nJ6C)WQD\nWM3)CZB\nJ9X)7J7\nCKV)KHJ\n53L)96R\nPSR)5BP\n7X8)TXF\nSCW)XC2\nDZL)S58\nZ9V)LZF\nFD8)X4G\n9TD)Y31\nM4P)LS4\n3GH)QKZ\nS58)DXN\n258)452\n31B)DXD\nGL3)2MY\n9GG)64M\nNYQ)9ZB\nRM9)3Q6\n1S1)6GC\n431)W3V\nW3V)CSN\nQDH)234\n52N)MXH\nQNJ)1Z9\nWJ9)1JF\n6WY)CH7\n21W)JJR\nY31)5QB\nK4V)QPD\nTS1)8VX\nGR6)HLJ\n1KT)7Y5\nPSX)64W\nYJN)R99\nPTG)CM7\n1XC)C32\nM1T)G48\n7XW)TW6\nQ7W)TYV\nZWB)X9K\nYGM)2Y3\n3GH)C1J\n6ZQ)4W4\nBY7)WRB\nBBN)CX6\n1XQ)ZC6\nG2N)RRW\nDT8)7QT\nRSH)P2F\nJGH)ZGL\nXC2)8HW\nMD9)JPQ\nS92)DFS\nB43)PL5\nC1W)MYN\nQQP)2SY\nSRY)S3L\n3QG)XYX\nXBY)XYN\nLS4)53L\nV8K)FH1\nLZF)SRV\n1DL)HDR\nY5H)RM9\n931)R77\nLYR)666\nDFS)C4D\nZ28)Y7D\nH6B)M1T\nCSN)TBD\nVMP)5DP\n91D)KHP\nPLH)LV1\nPGK)DB4\n2QX)93G\nTJB)Z7M\nW9K)L71\nC8J)9TD\nPN7)8JC\n94X)FD8\nGWY)258\nRM4)L64\nWPB)1HP\n1J8)H6B\nNZ5)YY6\n4B6)2PR\n9NV)W5W\n6LN)SJN\nGF8)RDQ\nP6S)HJ8\nG2N)6WP\nF92)BVV\nJV7)TQL\nQ91)PCG\nPFR)KF8\nQ1P)7BP\nL64)6WY\nZRD)PWW\nHFN)88M\nMZN)SYS\nPQL)Y26\n234)225\nVVP)37J\nPL5)T11\nCGK)PTG\nLZY)Z8V\nN9H)P6S\nCZQ)FBR\nTBP)MLT\nLLP)6S5\nYTT)9Q6\nH6S)SPZ\nR9K)XMH\n6PY)PLR\n4PC)HBK\nWFF)W9K\nP2F)FTY\nF97)SK7\nYCD)M6H\n2CR)84W\nLSP)GTT\nZ3J)QQP\nCCF)QJ1\nYW5)B68\n7FJ)83Q\nQKM)GQF\nZJ7)752\nY5H)83G\nY14)V53\n5G4)LHR\nGZZ)MR1\n46Z)4HQ\nT6X)FMD\nFBR)R74\nQ8H)3WR\nSVK)FKZ\nYXD)H4P\nNKV)WM3\nRDQ)GF3\nL3G)CP3\nHN7)VHL\nHBK)G8C\nWRB)WLY\n1V8)M37\nKHJ)BHH\nGL4)D94\nXR4)S5D\nXM8)ZWB\n5RY)2XT\nFCM)5DS\nKZ5)XXB\nT91)Y8B\nKNJ)F8L\nD2D)ST4\nQQ6)TC2\nGF3)RJK\n69P)7GT\nY26)TJZ\nB5J)8L8\nNMH)4YK\nSXJ)9S2\n752)CBN\nZGM)NZ5\nS1K)MZN\nMMC)Y29\n7QT)LM1\n8NX)JZG\nR95)GR4\nZXK)QQ6\nDNX)158\nQRX)GR6\nLRC)L7M\nX5V)SK4\nD4C)Y2N\n83Q)134\nGST)LQR\nR7K)6RR\n4G9)M8F\nC32)5SX\nYMW)RPN\nHHR)S99\n5D4)C9C\nSSL)KWJ\nFPW)H6V\nJT6)Q8M\n53T)QDH\n4YK)B42\nVFY)KLM\nHVD)SCW\n88F)V93\n6S5)5JM\nR8S)YBP\n2R4)C8G\n8VF)WYS\nCSZ)SSW\nJRB)WXM\nZT2)7HZ\nKJT)9DV\nM8F)SKM\nN12)SXJ\nMD9)6QH\n9GD)7T9\nZC6)LQY\nH6Q)R56\nS8T)27S\nB68)VFF\nP9B)88F\n666)PNZ\nMXL)NZY\n3MX)2M7\n3WR)T8J\nDNB)VC7\n84R)XNZ\n656)K4V\nBSK)FLM\nMB8)B43\nK3X)D2J\n7J7)JDF\nZ44)JMX\nQF3)FCM\n5F9)VKQ\nGXZ)1SF\n4JT)4PC\nW3W)R3T\nPMQ)69P\n3YF)9HH\nL74)CGL\n8T1)VPX\nY26)9XQ\n635)SSP\n7BP)PF5\n9L3)WPB\nJLP)YOU\n25P)7RG\n4R6)YJN\n9GD)PSX\nT3X)XFM\n8JC)CCF\nRPN)6FZ\nNZY)67W\nNXG)GL4\n6YN)6NP\nGX6)RQK\nG48)5RL\nCSZ)GX7\nYBP)P1X\nKJF)CG8\n43T)B78\nY5V)SSH\nDJH)2DL\nKL3)QN4\n5DS)4WW\nVG9)84R\nB64)8M8\n6FZ)94X\nZL9)Y5V\n68Y)MYK\nM7Y)JRY\nQSJ)K2Z\nJJR)J7G\nMXP)1QH\nM6H)WRF\n64C)FFC\nPJY)HGB\nZGL)LKH\n687)PSR\n7QD)TTD\nFLM)QH4\n57M)ZRD\nWQD)JRB\nSTJ)N7M\nRHS)2D1\nNFS)V9C\nP4C)NH1\nZJ8)431\nD2J)H8X\nJDF)C41\n64M)H1Z\nJRS)T95\nWXM)GRB\nMK2)8W1\n6NP)D4C\nN2C)SWJ\nTBD)JKN\nPTS)FN3\n1SF)VJV\n6WB)VB9\nF9K)M7B\n134)1V8\nRSQ)GVK\nS3L)V29\n4SY)DM1\nFCM)4G3\nQN4)T33\nFDB)WKK\nPQZ)LZY\nHS9)MB7\nCHP)74B\nLHR)TRV\n7Y5)NXG\nQBG)JWB\nZWF)T6Y\nWKF)BWB\n4XH)4R6\nJWB)GRL\nDWZ)D2F\nTHD)4DJ\nH1Z)GWS\nKZF)CCN\nVGY)L78\nMDX)RFG\nHJ8)38N\nL9Y)C1W\nC8G)VFK\n1KT)PLH\nCCN)Q97\n8VX)WTR\nRVX)H3D\nPCG)PDC\n58H)7XW\nMYK)77T\nB42)N3P\nCKP)HH3\nPY8)HS9\n844)T91\nGHQ)YQC\nC1J)GX6\nFMW)Y63\n9DM)68Y\nFFJ)ZVG\nCGK)274\nCX6)NWG\nJPQ)VMP\nH5L)BDP\nVRC)MK2\nCCX)948\nJHS)ZWF\nB6Q)6W5\nR77)FDZ\nVJR)FPW\nS1Q)GLD\nXDB)P9B\n3WR)33Y\nDZL)T8W\n8M8)LYR\nTW6)T7S\n4PR)7LP\nZNT)553\n5F8)S5F\nXNZ)F43\n32W)N7K\n5TV)PW2\nBKG)91D\n8W1)SRY\n5VM)2S3\nM6D)CCX\n77S)BSK\nG8C)CZQ\nDXN)23R\nLQR)GWY\nSHQ)YGM\n9DM)SVK\nZYT)YXD\nKL4)QG4\nHDR)XSH\n77T)DN6\nHH3)BT5\nSSP)QJ8\n5G4)ZN2\n6HM)H41\nJMX)7QD\nB57)DWB\n3V4)M7Y\nHJJ)6PY\nWLY)QPZ\nG1M)ZCB\nVFF)VGC\nVJV)X3Z\nW37)GFV\nX3Z)HGT\nFVW)8R4\nXYX)6ZQ", Scope = Public
	#tag EndConstant


	#tag ViewBehavior
		#tag ViewProperty
			Name="Name"
			Visible=true
			Group="ID"
			InitialValue=""
			Type="String"
			EditorType=""
		#tag EndViewProperty
		#tag ViewProperty
			Name="Index"
			Visible=true
			Group="ID"
			InitialValue="-2147483648"
			Type="Integer"
			EditorType=""
		#tag EndViewProperty
		#tag ViewProperty
			Name="Super"
			Visible=true
			Group="ID"
			InitialValue=""
			Type="String"
			EditorType=""
		#tag EndViewProperty
		#tag ViewProperty
			Name="Left"
			Visible=true
			Group="Position"
			InitialValue="0"
			Type="Integer"
			EditorType=""
		#tag EndViewProperty
		#tag ViewProperty
			Name="Top"
			Visible=true
			Group="Position"
			InitialValue="0"
			Type="Integer"
			EditorType=""
		#tag EndViewProperty
		#tag ViewProperty
			Name="CenterOfMass"
			Visible=false
			Group="Behavior"
			InitialValue=""
			Type="Integer"
			EditorType=""
		#tag EndViewProperty
	#tag EndViewBehavior
End Class
#tag EndClass
